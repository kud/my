#!/usr/bin/env zsh

################################################################################
#                                                                              #
#   ğŸš€ NEOVIM CONFIGURATION MANAGER                                            #
#   ------------------------------                                             #
#   Sets up modern Neovim with LazyVim configuration for a powerful          #
#   development environment with plugins, themes, and optimal settings.       #
#                                                                              #
################################################################################

source $MY/core/helper

echo_task_start "Setting up modern Neovim configuration"
echo_space

################################################################################
# ğŸ” NEOVIM INSTALLATION CHECK
################################################################################

# Check if Neovim is installed
if ! command -v nvim >/dev/null 2>&1; then
    echo_fail "Neovim is not installed. Install it via Homebrew first:"
    echo_info "Run: brew install neovim"
    return 1
fi

echo_info "Neovim found - proceeding with configuration"

################################################################################
# ğŸ“‚ CONFIGURATION DIRECTORY SETUP  
################################################################################

# Check if the config directory exists
if [[ ! -d "$HOME/.config/nvim" ]]; then
    echo_info "Creating Neovim configuration directory"
    mkdir -p "$HOME/.config/nvim"
    echo_success "Configuration directory created"
else
    echo_info "Neovim configuration directory already exists"
fi

# Clean up old vim-plug installation if it exists
if [[ -d "$HOME/.config/nvim/autoload" ]]; then
    echo_task_start "Cleaning up old vim-plug installation"
    rm -rf "$HOME/.config/nvim/autoload"
    rm -rf "$HOME/.config/nvim/plugged"
    echo_task_done "Old vim-plug removed"
fi

echo_space
echo_success "Modern Neovim setup complete!"
echo_info "Config location: ~/.config/nvim/init.lua"
echo_info "Features included:"
echo_info "  ğŸ” Telescope (fuzzy finder)"
echo_info "  ğŸŒ³ TreeSitter (syntax highlighting)"
echo_info "  ğŸ”§ Mason (LSP installer)"
echo_info "  ğŸ’¬ nvim-cmp (autocompletion)"
echo_info "  ğŸ¤– GitHub Copilot"
echo_info "  ğŸ“ Neo-tree (file explorer)"
echo_info "  âš¡ Gitsigns (git integration)"
echo_info "  ğŸ’… Lualine (status line)"

echo_space
echo_task_done "Neovim configuration completed"
echo_success "Modern Neovim development environment is ready! ğŸš€"
echo_info "Run 'nvim' to automatically install all plugins and start coding!"
