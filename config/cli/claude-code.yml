# Claude Code Configuration - Common
# Settings applied to all profiles

# Global settings (keys must match .claude.json keys exactly)
global:
  autoUpdates: true
  theme: dark-daltonized
# Settings (keys must match .claude/settings.json keys exactly)
settings:
  alwaysThinkingEnabled: true
  includeCoAuthoredBy: false
  statusLine:
    type: command
    command: |
      input=$(cat); trunc_mid() { local s="$1"; local max="$2"; if (( ${#s} > max )); then local head=$(( (max - 3) / 2 )); local tail=$(( max - 3 - head )); printf '%s...%s' "${s:0:head}" "${s: -tail}"; else printf '%s' "$s"; fi; }; cwd=$(echo "$input" | jq -r '.workspace.current_dir'); cd "$cwd" 2>/dev/null || exit 0; raw_path="${cwd/#$HOME/}"; raw_path=$(trunc_mid "$raw_path" 40); parent_dir=$(dirname "$raw_path"); last_dir=$(basename "$raw_path"); if [[ "$parent_dir" == "." ]]; then dir_display=$(printf '\033[38;2;0;146;186m%s\033[0m' "$last_dir"); else dir_display=$(printf '\033[38;2;255;1;116m%s/\033[38;2;0;146;186m%s\033[0m' "$parent_dir" "$last_dir"); fi; git_branch=""; if git rev-parse --git-dir > /dev/null 2>&1; then branch=$(git symbolic-ref --short HEAD 2>/dev/null || git rev-parse --short HEAD 2>/dev/null); if [[ -n "$branch" ]]; then branch=$(trunc_mid "$branch" 32); git_branch=$(printf ' \033[38;2;128;212;64m⎇ %s\033[0m' "$branch"); fi; fi; model=$(echo "$input" | jq -r 'if (.model|type)=="object" then (.model.display_name // .model.name // .model.id // empty) else (.model // empty) end'); model_display=$(printf ' \033[38;2;182;216;138m[%s]\033[0m' "${model:-?}"); printf '%s%s%s' "${dir_display}" "${git_branch}" "${model_display}"
  permissions:
    allow:
      - Bash(npm run test *)
      # Git read/inspect operations - auto-accept
      - Bash(git -C * rev-parse *)
      - Bash(git -C * status *)
      - Bash(git -C * log *)
      - Bash(git rev-parse *)
      - Bash(git status *)
      - Bash(git log *)
      - Bash(git diff *)
      # Regular git push - auto-accept
      - Bash(git push)
      - Bash(git push origin *)
      - Bash(git push -u *)
      - Bash(git push --set-upstream *)
      # Jira/Atlassian read operations - auto-accept
      - mcp__atlassian__get*
      - mcp__atlassian__search*
      - mcp__atlassian__fetch
      - mcp__atlassian__lookup*
      - mcp__atlassian__atlassianUserInfo
      # GitHub CLI read operations - auto-accept
      - Bash(gh pr list*)
      - Bash(gh pr view*)
      - Bash(gh pr diff*)
      - Bash(gh pr checks*)
      - Bash(gh pr status*)
      - Bash(gh issue list*)
      - Bash(gh issue view*)
      - Bash(gh issue status*)
      - Bash(gh repo view*)
      - Bash(gh repo list*)
      - Bash(gh search *)
      - Bash(gh api *)
      # GitHub CLI write operations - auto-accept
      - Bash(gh pr ready*)
      - Bash(gh pr merge*)
      - Bash(gh pr create*)
      # Jira/Atlassian write operations - auto-accept
      - mcp__atlassian__createJiraIssue
      - mcp__atlassian__editJiraIssue
      - mcp__atlassian__transitionJiraIssue
      - mcp__atlassian__addCommentToJiraIssue
      # File search - auto-accept
      - Bash(find *)
      # GitHub MCP read operations - auto-accept
      - mcp__github__get*
      - mcp__github__list*
      - mcp__github__search*
      - mcp__github__*_read
    ask:
      - Bash(npm publish *)
      # Force push - requires confirmation
      - Bash(git push --force*)
      - Bash(git push -f*)
      - Bash(git push *--force*)
      - Bash(git push *-f*)
      - Bash(rm -rf *)
    deny:
      - Read(.env*)

# Common MCP servers (all profiles)
mcp:
  github:
    transport: http
    url: https://api.githubcopilot.com/mcp
    headers:
      Authorization: Bearer ${MCP_GITHUB_TOKEN}
  notion:
    transport: http
    url: https://mcp.notion.com/mcp
  excalidraw:
    transport: http
    url: https://mcp.excalidraw.com/mcp
  whimsical:
    transport: http
    url: http://localhost:21190/mcp
  basic-memory:
    enabled: false
    transport: stdio
    command: uvx
    args:
      - --python
      - "3.12"
      - basic-memory
      - mcp
    env: {}
